<!DOCTYPE html>
<html>
<head>
  <title>Pass Picker</title>
  <meta charset="UTF-8" />
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; }
    label, input, button { display: block; margin: 10px 0; width: 100%; }
  </style>
</head>
<body>
  <h1>ðŸŽ¿ Find Your Perfect Ski Pass</h1>

  <form id="pvsa-form">
    <label>Total Ski Days:
      <input type="number" name="total_days" required min="1" value="10" />
    </label>
    <label>Your Latitude:
      <input type="number" name="user_lat" step="any" required value="42.3601" />
    </label>
    <label>Your Longitude:
      <input type="number" name="user_lon" step="any" required value="-71.0589" />
    </label>
    <label>Ski Weekends?
      <input type="checkbox" name="ski_weekends" checked />
    </label>
    <button type="submit">Get Recommendations</button>
  </form>

  <div id="results"></div>

  <script>
    const form = document.getElementById("pvsa-form");
    const resultsDiv = document.getElementById("results");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      resultsDiv.innerHTML = "Calculating...";

      const formData = new FormData(form);
      const data = {
        total_days: Number(formData.get("total_days")),
        user_lat: parseFloat(formData.get("user_lat")),
        user_lon: parseFloat(formData.get("user_lon")),
        ski_weekends: formData.get("ski_weekends") !== null
      };

      const response = await fetch("https://pass-picker.onrender.com", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      const result = await response.json();
      resultsDiv.innerHTML = `
        <h2>Pass Day Score: ${result.total_pass_day_score}</h2>
        <ul>
          ${result.resorts_scored.map(r => `
            <li><strong>${r.resort}</strong> â€” ${r.days_used} days @ ${r.distance_miles} mi (${r.weighted_score} pts)</li>
          `).join("")}
        </ul>
      `;
    });
  </script>
</body>
</html>
